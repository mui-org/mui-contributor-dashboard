apiVersion: v1
kind: page
spec:
  id: ck33hgb
  title: CommunityPercentPRsMerged
  content:
    - component: PageRow
      name: pageRow
      children:
        - component: TextField
          name: slug
          props:
            label: Repository slug
            defaultValue: mui/material-ui
    - component: PageRow
      name: pageRow2
      children:
        - component: Text
          name: text
          props:
            value:
              $$jsExpression: |
                (() => {
                  if (getRepositoryDetails.data) {
                    return `Repository ID: ${getRepositoryDetails.data.data.id}`
                  } else {
                    return "Not found"
                  }
                })()
    - component: PageRow
      name: pageRow3
      children:
        - component: Text
          name: text1
          props:
            value: "Community: PRs merged per month"
            variant: h6
            sx:
              mt: 2
    - component: PageRow
      name: pageRow1
      children:
        - component: codeComponent.Chart
          name: codeComponent_Chart
          props:
            data:
              $$jsExpression: |
                PRsPerMonth.rows
    - component: PageRow
      name: pageRow5
      children:
        - component: Text
          name: text2
          props:
            value: "Community: Unique contributors per month"
            variant: h6
            sx:
              mt: 2
    - component: PageRow
      name: pageRow4
      children:
        - component: codeComponent.Chart
          name: codeComponent_Chart1
          props:
            data:
              $$jsExpression: |
                ContributorsPerMonth.rows
  queries:
    - name: PRsPerMonth
      query:
        function: PRsPerMonth
        kind: local
      parameters:
        - name: repositoryId
          value:
            $$jsExpression: |
              getRepositoryDetails.data.data.id
    - name: getRepositoryDetails
      query:
        function: getRepositoryDetails
        kind: local
      parameters:
        - name: slug
          value:
            $$jsExpression: |
              slug.value
    - name: ContributorsPerMonth
      query:
        function: ContributorsPerMonth
        kind: local
      parameters:
        - name: repositoryId
          value:
            $$jsExpression: |
              getRepositoryDetails.data.data.id
